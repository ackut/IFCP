{% extends 'general.html' %}
{% set users = context.User.query.all() %}
{% set logs = context.Logs.query.order_by(context.Logs.creation_date).all() %}

{% block content %}
{{ super() }}

<div class="container">
    <div class="content">
        <h1>Панель администратора</h1>
        <div style="background-color: rgb(191, 220, 248);">
            <div style="background-color: rgb(247, 214, 214);">
                <h3>Добавление пользователя</h3>
                <form id="create_user">
                    <p>Публичное имя</p>
                    <input type="text" name="name" spellcheck="false" autocomplete="off" maxlength="32" required>

                    <p>Статус</p>
                    <input type="text" name="status" spellcheck="false" autocomplete="off" maxlength="1" required>

                    <p>Логин</p>
                    <input type="text" name="login" spellcheck="false" autocomplete="off" maxlength="16" required>

                    <p>Пароль</p>
                    <input type="password" name="password" autocomplete="off" maxlength="32" required>
                    
                    <input type="text" name="create_user" hidden>
                    <input type="submit" value="Добавить">
                </form>

                <h3>Список пользователей</h3>
                <div id="users_list">
                    {% if users %}
                    {% for user in users %}
                    <p>{{ user.name }} | {{ user.login }} | {{ user.status }} | Добавил: {{ user.creator }} - {{ user.creation_date }}</p>
                    {% endfor %}
                    {% else %}
                    <p>Пользователей ниту.</p>
                    {% endif %}
                </div>
            </div>
        </div>

        <hr>

        <div style="background-color: rgb(180, 233, 235);">
            <h3>Логи</h3>
            {% if logs %}
            {% for log in logs %}
            <p>{{ log.priority }}, {{ log.creator }}, {{ log.text }}, {{ log.creation_date }} </p>
            {% endfor %}
            {% else %}
            <p>Данные отсутствуют.</p>
            {% endif %}
        </div>


    </div>
</div>

<script src="../static/js/admin.js"></script>

{% endblock %}